import{g as Ee,a as Ie,r as m,i as ze,U as $,c as pe,s as Z,j as e,d as ye,e as Ve,P as oe,m as ge,W as Le,X as Be,h as B,n as qe,o as De,p as We,q as Re,L as Ue,C as $e,t as d,y as ee,T as o,H as A,N as V,D as Ze,Y as se,E as re,A as te,S as l,F as L,v as g,I as v,O as P,w as f,x as w,Z as ue,V as he,z as fe}from"./index-MmmTvTN2.js";import{A as Ye,S as He,a as xe,b as be}from"./ArrowBack-CyNcoCNp.js";function Ke(a){return Ee("MuiMobileStepper",a)}Ie("MuiMobileStepper",["root","positionBottom","positionTop","positionStatic","dots","dot","dotActive","progress"]);const _e=a=>{const{classes:c,position:h}=a,S={root:["root",`position${ye(h)}`],dots:["dots"],dot:["dot"],dotActive:["dotActive"],progress:["progress"]};return Ve(S,Ke,c)},Qe=Z(oe,{name:"MuiMobileStepper",slot:"Root",overridesResolver:(a,c)=>{const{ownerState:h}=a;return[c.root,c[`position${ye(h.position)}`]]}})(ge(({theme:a})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",background:(a.vars||a).palette.background.default,padding:8,variants:[{props:({position:c})=>c==="top"||c==="bottom",style:{position:"fixed",left:0,right:0,zIndex:(a.vars||a).zIndex.mobileStepper}},{props:{position:"top"},style:{top:0}},{props:{position:"bottom"},style:{bottom:0}}]}))),Xe=Z("div",{name:"MuiMobileStepper",slot:"Dots",overridesResolver:(a,c)=>c.dots})({variants:[{props:{variant:"dots"},style:{display:"flex",flexDirection:"row"}}]}),Ge=Z("div",{name:"MuiMobileStepper",slot:"Dot",shouldForwardProp:a=>Le(a)&&a!=="dotActive",overridesResolver:(a,c)=>{const{dotActive:h}=a;return[c.dot,h&&c.dotActive]}})(ge(({theme:a})=>({variants:[{props:{variant:"dots"},style:{transition:a.transitions.create("background-color",{duration:a.transitions.duration.shortest}),backgroundColor:(a.vars||a).palette.action.disabled,borderRadius:"50%",width:8,height:8,margin:"0 2px"}},{props:{variant:"dots",dotActive:!0},style:{backgroundColor:(a.vars||a).palette.primary.main}}]}))),Je=Z(Be,{name:"MuiMobileStepper",slot:"Progress",overridesResolver:(a,c)=>c.progress})({variants:[{props:{variant:"progress"},style:{width:"50%"}}]}),es=m.forwardRef(function(c,h){const S=ze({props:c,name:"MuiMobileStepper"}),{activeStep:k=0,backButton:p,className:ie,LinearProgressProps:u,nextButton:q,position:D="bottom",steps:O,variant:r="dots",slots:Y={},slotProps:i={},...E}=S,x={...S,activeStep:k,position:D,variant:r};let T;r==="progress"&&(O===1?T=100:T=Math.ceil(k/(O-1)*100));const n=_e(x),N={slots:Y,slotProps:{progress:u,...i}},[I,H]=$("root",{ref:h,elementType:Qe,shouldForwardComponentProp:!0,className:pe(n.root,ie),externalForwardedProps:{...N,...E},ownerState:x,additionalProps:{square:!0,elevation:0}}),[z,K]=$("dots",{className:n.dots,elementType:Xe,externalForwardedProps:N,ownerState:x}),[_,W]=$("dot",{elementType:Ge,externalForwardedProps:N,ownerState:x}),[Q,X]=$("progress",{className:n.progress,elementType:Je,shouldForwardComponentProp:!0,externalForwardedProps:N,ownerState:x,additionalProps:{value:T,variant:"determinate"}});return e.jsxs(I,{...H,children:[p,r==="text"&&e.jsxs(m.Fragment,{children:[k+1," / ",O]}),r==="dots"&&e.jsx(z,{...K,children:[...new Array(O)].map((b,F)=>e.jsx(_,{...W,className:pe(n.dot,W.className,F===k&&n.dotActive),dotActive:F===k},F))}),r==="progress"&&e.jsx(Q,{...X}),q]})}),je=B(e.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),ss=B(e.jsx("path",{fillRule:"evenodd",d:"m9 17 3-2.94c-.39-.04-.68-.06-1-.06-2.67 0-8 1.34-8 4v2h9zm2-5c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m4.47 8.5L12 17l1.4-1.41 2.07 2.08 5.13-5.17 1.4 1.41z"}),"HowToReg"),rs=B(e.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft"),ts=B(e.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight"),os=B(e.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm-2 16-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9z"}),"VerifiedUser");function ns(){var me;const{signup:a,verifyOtp:c,sendOtpByEmail:h,sendOtpBySms:S,setskipemailotp:k,skipemailotp:p,setskipsmsotp:ie,skipsmsotp:u}=qe(),q=De(),D=We(),O=Re(D.breakpoints.down("sm")),[r,Y]=m.useState({firstName:"",lastName:"",email:"",phoneNumber:"",password:"",confirmPassword:"",emailOtp:"",phoneOtp:""}),[i,E]=m.useState({}),[x,T]=m.useState(!1),[n,N]=m.useState(0),[I,H]=m.useState(!1),[z,K]=m.useState(!1),[_,W]=m.useState(!1),[Q,X]=m.useState(!1),[b,F]=m.useState(!1),[C,ae]=m.useState(!1),[ne,R]=m.useState(!1),[le,U]=m.useState(!1),[G,de]=m.useState(!1),[J,ce]=m.useState(!1),M=[{label:"Name",fields:["firstName","lastName"],icon:e.jsx(se,{})},{label:"Contact",fields:["email","phoneNumber"],icon:e.jsx(re,{})},{label:"Security",fields:["password","confirmPassword"],icon:e.jsx(te,{})},{label:"Verify",fields:["emailOtp","phoneOtp"],icon:e.jsx(os,{})}],j=((me=M[n])==null?void 0:me.fields)||[];m.useEffect(()=>{p&&F(!0),u&&ae(!0)},[p,u]);const y=s=>{const{name:t,value:Me}=s.target;Y({...r,[t]:Me}),i[t]&&E({...i,[t]:null})},ve=()=>{let s={},t=!0;return j.includes("firstName")&&!r.firstName.trim()&&(s.firstName="First name is required",t=!1),j.includes("lastName")&&!r.lastName.trim()&&(s.lastName="Last name is required",t=!1),j.includes("email")&&(r.email.trim()?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(r.email)||(s.email="Please enter a valid email address",t=!1):(s.email="Email is required",t=!1)),j.includes("phoneNumber")&&(r.phoneNumber.trim()?/^[0-9]{10}$/.test(r.phoneNumber)||(s.phoneNumber="Please enter a valid 10-digit phone number",t=!1):(s.phoneNumber="Phone number is required",t=!1)),j.includes("password")&&(r.password?r.password.length<6&&(s.password="Password must be at least 6 characters",t=!1):(s.password="Password is required",t=!1)),j.includes("confirmPassword")&&(r.confirmPassword?r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match",t=!1):(s.confirmPassword="Please confirm your password",t=!1)),j.includes("emailOtp")&&!p&&!b&&(r.emailOtp.trim()?/^[0-9]{6}$/.test(r.emailOtp)||(s.emailOtp="OTP must be 6 digits",t=!1):(s.emailOtp="Email OTP is required",t=!1)),j.includes("phoneOtp")&&!u&&!C&&(r.phoneOtp.trim()?/^[0-9]{6}$/.test(r.phoneOtp)||(s.phoneOtp="OTP must be 6 digits",t=!1):(s.phoneOtp="Phone OTP is required",t=!1)),E(s),t},Pe=()=>{let s={};return r.firstName.trim()||(s.firstName="First name is required"),r.lastName.trim()||(s.lastName="Last name is required"),r.email.trim()?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(r.email)||(s.email="Please enter a valid email address"):s.email="Email is required",r.phoneNumber.trim()?/^[0-9]{10}$/.test(r.phoneNumber)||(s.phoneNumber="Please enter a valid 10-digit phone number"):s.phoneNumber="Phone number is required",r.password?r.password.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required",r.confirmPassword?r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",E(s),Object.keys(s).length===0},we=()=>{ve()&&(n===2&&Oe(),N(s=>s+1))},Se=()=>{N(s=>s-1)},Oe=async()=>{if(!p&&!_){R(!0);try{const s=await h(r.email);s!=null&&s.valid?(W(!0),l.success("OTP sent to your email")):l.error((s==null?void 0:s.message)||"Failed to send email OTP")}catch(s){console.error("Email OTP error:",s),l.error("Failed to send email OTP")}finally{R(!1)}}if(!u&&!Q){U(!0);try{const s=await S(r.phoneNumber);s!=null&&s.valid?(X(!0),l.success("OTP sent to your phone")):l.error((s==null?void 0:s.message)||"Failed to send SMS OTP")}catch(s){console.error("SMS OTP error:",s),l.error("Failed to send SMS OTP")}finally{U(!1)}}},Ne=async()=>{if(r.emailOtp.trim()&&!b){de(!0);try{const s=await c(r.email,r.emailOtp);s!=null&&s.valid?(F(!0),l.success("Email verified successfully")):l.error((s==null?void 0:s.message)||"Invalid email OTP")}catch(s){console.error("Email verification error:",s),l.error("Email verification failed")}finally{de(!1)}}},Ce=async()=>{if(r.phoneOtp.trim()&&!C){ce(!0);try{const s=await c(r.phoneNumber,r.phoneOtp);s!=null&&s.valid?(ae(!0),l.success("Phone verified successfully")):l.error((s==null?void 0:s.message)||"Invalid phone OTP")}catch(s){console.error("Phone verification error:",s),l.error("Phone verification failed")}finally{ce(!1)}}},Ae=async()=>{R(!0);try{const s=await h(r.email);s!=null&&s.valid?l.success("OTP resent to your email"):l.error((s==null?void 0:s.message)||"Failed to resend email OTP")}catch(s){console.error("Email OTP error:",s),l.error("Failed to resend email OTP")}finally{R(!1)}},ke=async()=>{U(!0);try{const s=await S(r.phoneNumber);s!=null&&s.valid?l.success("OTP resent to your phone"):l.error((s==null?void 0:s.message)||"Failed to resend SMS OTP")}catch(s){console.error("SMS OTP error:",s),l.error("Failed to resend SMS OTP")}finally{U(!1)}},Te=async s=>{if(s.preventDefault(),n===M.length&&(!p&&!b||!u&&!C)){l.error("Please verify your email and phone number");return}if(Pe()){T(!0);try{const t=await a(r);t!=null&&t.valid?(l.success("Account created successfully!"),setTimeout(()=>q("/login"),2e3)):l.error((t==null?void 0:t.message)||"Registration failed. Please try again.")}catch(t){console.error("Signup error:",t),l.error("Registration failed. Please try again later.")}finally{T(!1)}}},Fe=s=>{switch(s){case 0:return e.jsx(L,{in:n===0,timeout:500,children:e.jsxs(d,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,color:"primary",children:"Let's get started with your name"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Please enter your first and last name as it appears on your official documents."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.firstName,children:[e.jsx(v,{htmlFor:"firstName",children:"First Name"}),e.jsx(P,{id:"firstName",name:"firstName",value:r.firstName,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(se,{color:"action"})}),label:"First Name",autoFocus:!0}),i.firstName&&e.jsx(w,{children:i.firstName})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.lastName,children:[e.jsx(v,{htmlFor:"lastName",children:"Last Name"}),e.jsx(P,{id:"lastName",name:"lastName",value:r.lastName,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(se,{color:"action"})}),label:"Last Name"}),i.lastName&&e.jsx(w,{children:i.lastName})]})]})});case 1:return e.jsx(L,{in:n===1,timeout:500,children:e.jsxs(d,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,color:"primary",children:"Your contact information"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"We'll use these details to verify your account and keep you updated."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.email,children:[e.jsx(v,{htmlFor:"email",children:"Email Address"}),e.jsx(P,{id:"email",type:"email",name:"email",value:r.email,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(re,{color:"action"})}),label:"Email Address",autoFocus:!0}),i.email&&e.jsx(w,{children:i.email})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.phoneNumber,children:[e.jsx(v,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(P,{id:"phoneNumber",name:"phoneNumber",value:r.phoneNumber,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(ue,{color:"action"})}),label:"Phone Number"}),i.phoneNumber&&e.jsx(w,{children:i.phoneNumber})]})]})});case 2:return e.jsx(L,{in:n===2,timeout:500,children:e.jsxs(d,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,color:"primary",children:"Create a secure password"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Your password should be at least 6 characters long and include a mix of letters and numbers."}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.password,children:[e.jsx(v,{htmlFor:"password",children:"Password"}),e.jsx(P,{id:"password",type:I?"text":"password",name:"password",value:r.password,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(te,{color:"action"})}),endAdornment:e.jsx(f,{position:"end",children:e.jsx(ee,{"aria-label":"toggle password visibility",onClick:()=>H(!I),edge:"end",children:I?e.jsx(he,{}):e.jsx(fe,{})})}),label:"Password",autoFocus:!0}),i.password&&e.jsx(w,{children:i.password})]}),e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.confirmPassword,children:[e.jsx(v,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(P,{id:"confirmPassword",type:z?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:y,startAdornment:e.jsx(f,{position:"start",children:e.jsx(te,{color:"action"})}),endAdornment:e.jsx(f,{position:"end",children:e.jsx(ee,{"aria-label":"toggle confirm password visibility",onClick:()=>K(!z),edge:"end",children:z?e.jsx(he,{}):e.jsx(fe,{})})}),label:"Confirm Password"}),i.confirmPassword&&e.jsx(w,{children:i.confirmPassword})]})]})});case 3:return e.jsx(L,{in:n===3,timeout:500,children:e.jsxs(d,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,color:"primary",children:"Verify your contact information"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Enter the verification codes sent to your email and phone number."}),!p&&e.jsxs(d,{sx:{mb:3},children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(re,{color:"primary",sx:{mr:1}}),e.jsx(o,{variant:"subtitle1",children:"Email Verification"}),b&&e.jsxs(d,{sx:{ml:1,display:"flex",alignItems:"center",color:"success.main"},children:[e.jsx(je,{fontSize:"small"}),e.jsx(o,{variant:"body2",color:"success.main",children:"Verified"})]})]}),b?e.jsx(o,{variant:"body2",color:"success.main",sx:{mt:1},children:"Your email has been successfully verified."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.emailOtp,children:[e.jsx(v,{htmlFor:"emailOtp",children:"Email OTP"}),e.jsx(P,{id:"emailOtp",name:"emailOtp",value:r.emailOtp,onChange:y,label:"Email OTP",disabled:G,endAdornment:e.jsx(f,{position:"end",children:e.jsx(A,{variant:"text",size:"small",onClick:Ne,disabled:!r.emailOtp||G,children:G?e.jsx(V,{size:20}):"Verify"})})}),i.emailOtp&&e.jsx(w,{children:i.emailOtp})]}),e.jsx(A,{variant:"text",size:"small",onClick:Ae,disabled:ne,sx:{mt:1},children:ne?e.jsx(V,{size:20}):"Resend OTP"})]})]}),!u&&e.jsxs(d,{children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ue,{color:"primary",sx:{mr:1}}),e.jsx(o,{variant:"subtitle1",children:"Phone Verification"}),C&&e.jsxs(d,{sx:{ml:1,display:"flex",alignItems:"center",color:"success.main"},children:[e.jsx(je,{fontSize:"small"}),e.jsx(o,{variant:"body2",color:"success.main",children:"Verified"})]})]}),C?e.jsx(o,{variant:"body2",color:"success.main",sx:{mt:1},children:"Your phone number has been successfully verified."}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{fullWidth:!0,margin:"normal",error:!!i.phoneOtp,children:[e.jsx(v,{htmlFor:"phoneOtp",children:"Phone OTP"}),e.jsx(P,{id:"phoneOtp",name:"phoneOtp",value:r.phoneOtp,onChange:y,label:"Phone OTP",disabled:J,endAdornment:e.jsx(f,{position:"end",children:e.jsx(A,{variant:"text",size:"small",onClick:Ce,disabled:!r.phoneOtp||J,children:J?e.jsx(V,{size:20}):"Verify"})})}),i.phoneOtp&&e.jsx(w,{children:i.phoneOtp})]}),e.jsx(A,{variant:"text",size:"small",onClick:ke,disabled:le,sx:{mt:1},children:le?e.jsx(V,{size:20}):"Resend OTP"})]})]}),p&&u&&e.jsx(o,{variant:"body2",color:"info.main",sx:{mt:3},children:"Verification step has been skipped based on system configuration."})]})});case 4:return e.jsx(L,{in:n===4,timeout:500,children:e.jsxs(d,{sx:{textAlign:"center",py:2},children:[e.jsx(ss,{color:"success",sx:{fontSize:60,mb:2}}),e.jsx(o,{variant:"h5",gutterBottom:!0,color:"primary",fontWeight:"bold",children:"Ready to create your account"}),e.jsx(o,{variant:"body1",sx:{mb:2},children:"Please review your information before submitting:"}),e.jsxs(oe,{variant:"outlined",sx:{p:2,mb:3,bgcolor:"background.default"},children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Name:"}),e.jsxs(o,{variant:"body2",children:[r.firstName," ",r.lastName]})]}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Email:"}),e.jsx(o,{variant:"body2",children:r.email})]}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Phone:"}),e.jsx(o,{variant:"body2",children:r.phoneNumber})]}),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Verification Status:"}),e.jsxs(d,{children:[!p&&e.jsxs(o,{variant:"body2",color:b?"success.main":"error.main",children:["Email: ",b?"Verified":"Not Verified"]}),!u&&e.jsxs(o,{variant:"body2",color:C?"success.main":"error.main",children:["Phone: ",C?"Verified":"Not Verified"]}),p&&u&&e.jsx(o,{variant:"body2",children:"Verification Skipped"})]})]})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:'By clicking "Create Account", you agree to our Terms of Service and Privacy Policy.'})]})});default:return null}};return e.jsx(Ue,{title:"Vmarg - Sign Up",children:e.jsxs($e,{maxWidth:"sm",sx:{py:{xs:2,sm:4}},children:[e.jsxs(d,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(ee,{onClick:()=>q("/login"),sx:{color:"primary.main"},children:e.jsx(Ye,{})}),e.jsx(o,{variant:"h5",component:"h1",fontWeight:"bold",textAlign:"center",sx:{flex:1},children:"Create Account"}),e.jsx(d,{sx:{width:40}})," "]}),e.jsxs(oe,{elevation:2,sx:{borderRadius:2,overflow:"hidden",backgroundColor:"background.paper"},children:[!O&&e.jsxs(He,{activeStep:n,alternativeLabel:!0,sx:{pt:3,pb:2,px:2,bgcolor:"background.subtle"},children:[M.map((s,t)=>e.jsx(xe,{children:e.jsx(be,{StepIconProps:{icon:t===n?s.icon:t<n?"✓":t+1},children:s.label})},s.label)),e.jsx(xe,{children:e.jsx(be,{children:"Review"})},"review")]}),e.jsxs(d,{sx:{p:3},children:[Fe(n),e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[e.jsx(A,{variant:"outlined",onClick:Se,disabled:n===0,startIcon:e.jsx(rs,{}),children:"Back"}),n===M.length?e.jsx(A,{variant:"contained",onClick:Te,disabled:x,startIcon:x?e.jsx(V,{size:20}):null,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#00635a"},px:3},children:x?"Creating Account...":"Create Account"}):e.jsx(A,{variant:"contained",onClick:we,endIcon:e.jsx(ts,{}),sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#00635a"}},children:n===M.length-1?"Review":"Next"})]})]}),O&&e.jsx(es,{variant:"dots",steps:M.length+1,position:"static",activeStep:n,sx:{bgcolor:"background.default"},nextButton:e.jsx("div",{}),backButton:e.jsx("div",{})})]}),e.jsx(d,{sx:{mt:3,textAlign:"center"},children:e.jsxs(o,{variant:"body2",children:["Already have an account?"," ",e.jsx(Ze,{to:"/login",style:{color:D.palette.primary.main,textDecoration:"none",fontWeight:"bold"},children:"Log in"})]})})]})})}export{ns as default};
