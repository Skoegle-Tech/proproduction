import{g as xe,a as fe,r as l,u as Pe,b as De,j as e,s as ie,c as ve,d as E,e as be,B as Be,f as ye,h as G,i as ze,m as Ae,k as re,l as ce,n as Oe,o as $e,p as Le,q as le,L as Re,C as Fe,F as Q,P as Ee,G as Y,t as u,T as g,v as X,I as ee,O as te,w as q,E as de,x as oe,y as Me,V as Ne,z as Ve,A as We,D as ne,H as ae,J as He,K as Ue,M as Ze,N as me,Q as ue,R as qe,S as f}from"./index-DPW6jzPA.js";import{S as Ge,a as pe,b as ge,A as Je}from"./ArrowBack-BExTR3lz.js";function _e(t){return xe("PrivateSwitchBase",t)}fe("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Ke=t=>{const{classes:n,checked:d,disabled:v,edge:h}=t,b={root:["root",d&&"checked",v&&"disabled",h&&`edge${E(h)}`],input:["input"]};return be(b,_e,n)},Qe=ie(Be)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:t,ownerState:n})=>t==="start"&&n.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:t,ownerState:n})=>t==="end"&&n.size!=="small",style:{marginRight:-12}}]}),Ye=ie("input",{shouldForwardProp:ye})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Xe=l.forwardRef(function(n,d){const{autoFocus:v,checked:h,checkedIcon:b,className:I,defaultChecked:y,disabled:S,disableFocusRipple:a=!1,edge:w=!1,icon:c,id:T,inputProps:P,inputRef:D,name:C,onBlur:B,onChange:r,onFocus:L,readOnly:M,required:J=!1,tabIndex:A,type:z,value:R,...N}=n,[O,V]=Pe({controlled:h,default:!!y,name:"SwitchBase",state:"checked"}),j=De(),W=x=>{L&&L(x),j&&j.onFocus&&j.onFocus(x)},H=x=>{B&&B(x),j&&j.onBlur&&j.onBlur(x)},_=x=>{if(x.nativeEvent.defaultPrevented)return;const $=x.target.checked;V($),r&&r(x,$)};let k=S;j&&typeof k>"u"&&(k=j.disabled);const U=z==="checkbox"||z==="radio",F={...n,checked:O,disabled:k,disableFocusRipple:a,edge:w},Z=Ke(F);return e.jsxs(Qe,{component:"span",className:ve(Z.root,I),centerRipple:!0,focusRipple:!a,disabled:k,tabIndex:null,role:void 0,onFocus:W,onBlur:H,ownerState:F,ref:d,...N,children:[e.jsx(Ye,{autoFocus:v,checked:h,defaultChecked:y,className:Z.input,disabled:k,id:U?T:void 0,name:C,onChange:_,readOnly:M,ref:D,required:J,ownerState:F,tabIndex:A,type:z,...z==="checkbox"&&R===void 0?{}:{value:R},...P}),O?b:c]})}),et=G(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),tt=G(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),ot=G(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function nt(t){return xe("MuiCheckbox",t)}const se=fe("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),at=t=>{const{classes:n,indeterminate:d,color:v,size:h}=t,b={root:["root",d&&"indeterminate",`color${E(v)}`,`size${E(h)}`]},I=be(b,nt,n);return{...n,...I}},st=ie(Xe,{shouldForwardProp:t=>ye(t)||t==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:d}=t;return[n.root,d.indeterminate&&n.indeterminate,n[`size${E(d.size)}`],d.color!=="default"&&n[`color${E(d.color)}`]]}})(Ae(({theme:t})=>({color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:re(t.palette.action.active,t.palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(ce()).map(([n])=>({props:{color:n,disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:re(t.palette[n].main,t.palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(ce()).map(([n])=>({props:{color:n},style:{[`&.${se.checked}, &.${se.indeterminate}`]:{color:(t.vars||t).palette[n].main},[`&.${se.disabled}`]:{color:(t.vars||t).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}))),it=e.jsx(tt,{}),rt=e.jsx(et,{}),ct=e.jsx(ot,{}),lt=l.forwardRef(function(n,d){const v=ze({props:n,name:"MuiCheckbox"}),{checkedIcon:h=it,color:b="primary",icon:I=rt,indeterminate:y=!1,indeterminateIcon:S=ct,inputProps:a,size:w="medium",disableRipple:c=!1,className:T,...P}=v,D=y?S:I,C=y?S:h,B={...v,disableRipple:c,color:b,indeterminate:y,size:w},r=at(B);return e.jsx(st,{type:"checkbox",inputProps:{"data-indeterminate":y,...a},icon:l.cloneElement(D,{fontSize:D.props.fontSize??w}),checkedIcon:l.cloneElement(C,{fontSize:C.props.fontSize??w}),ownerState:B,ref:d,className:ve(r.root,T),disableRipple:c,...P,classes:r})}),he=G(e.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security"),dt={"akriti786shukla@gmail.com":!1,"manojgowda@skoegle.com":!1,"manojgowdabr89@gmail.com":!1};function pt(){const{login:t,setisAdmin:n,setisLogin:d,skipotp:v,verifyOtp:h,sendOtpByEmail:b}=Oe(),I=$e(),y=Le(),S=le(y.breakpoints.down("md"));le(y.breakpoints.down("sm"));const[a,w]=l.useState({email:"",password:"",otp:"",devicedetails:"Not Available",loginTime:"",clientInfo:{}}),[c,T]=l.useState({}),[P,D]=l.useState(!1),[C,B]=l.useState(!1),[r,L]=l.useState("login"),[M,J]=l.useState(0),[A,z]=l.useState(0),[R,N]=l.useState(!1),[O,V]=l.useState(!1),[j,W]=l.useState(!1),[H,_]=l.useState(!0);l.useEffect(()=>{let o;return A>0?o=setInterval(()=>{z(A-1)},1e3):N(!1),()=>clearInterval(o)},[A]);const k=()=>new Date().toISOString().replace("T"," ").substr(0,19),U=()=>{const o=Intl.DateTimeFormat().resolvedOptions().timeZone,s=new Date().getTimezoneOffset(),i=Math.abs(Math.floor(s/60)),m=Math.abs(s%60),K=s>0?"-":"+";return`${o} (UTC${K}${i.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")})`},F=()=>{var o;return{screenWidth:window.screen.width,screenHeight:window.screen.height,colorDepth:window.screen.colorDepth,pixelRatio:window.devicePixelRatio,screenOrientation:((o=screen.orientation)==null?void 0:o.type)||"N/A"}},Z=async()=>{let o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return o?{effectiveType:o.effectiveType,downlink:o.downlink,rtt:o.rtt,saveData:o.saveData}:"Network info not available"},x=()=>({userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,languages:navigator.languages,cookiesEnabled:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack,vendor:navigator.vendor,maxTouchPoints:navigator.maxTouchPoints,hardwareConcurrency:navigator.hardwareConcurrency,deviceMemory:navigator.deviceMemory||"N/A"});l.useEffect(()=>{(async()=>{try{const s=await navigator.getBattery(),i={level:(s.level*100).toFixed(0),charging:s.charging,chargingTime:s.chargingTime,dischargingTime:s.dischargingTime},m=await Z(),K=F(),Se=x(),p={loginDateTime:k(),timeZone:U(),battery:i,network:m,screen:K,browser:Se,platform:{os:navigator.platform,vendor:navigator.vendor,userAgent:navigator.userAgent}},Ce=`Login Time (UTC): ${p.loginDateTime}
          TimeZone: ${p.timeZone}
          Device: ${p.platform.os}
          Browser: ${p.browser.vendor}
          Screen: ${p.screen.screenWidth}x${p.screen.screenHeight}
          Battery: ${p.battery.level}% (${p.battery.charging?"Charging":"Not Charging"})
          Network: ${typeof p.network=="object"?p.network.effectiveType:"N/A"}
          Language: ${p.browser.language}`.trim();w(Te=>({...Te,devicedetails:Ce,loginTime:p.loginDateTime,clientInfo:p})),W(!0)}catch(s){console.error("Error fetching device details: ",s);const i={loginDateTime:k(),timeZone:U(),platform:navigator.platform,userAgent:navigator.userAgent};w(m=>({...m,devicedetails:`Login Time: ${i.loginDateTime}, Device: ${i.platform}`,loginTime:i.loginDateTime,clientInfo:i})),W(!0),f.error("Error fetching complete device details")}})()},[]);const $=o=>{const{name:s,value:i}=o.target;w({...a,[s]:i}),c[s]&&T({...c,[s]:null})},we=()=>{const o={};return a.email?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(a.email)||(o.email="Please enter a valid email address"):o.email="Email is required",r==="login"&&!a.password?o.password="Password is required":r==="login"&&a.password.length<6&&(o.password="Password must be at least 6 characters"),r==="otp"&&!a.otp&&(o.otp="OTP is required"),T(o),Object.keys(o).length===0},je=async o=>{if(o.preventDefault(),we()){D(!0);try{if(v||dt[a.email]){const s={...a,loginTimestamp:k()},i=await t(s);i!=null&&i.valid?(d(i.valid),n(i.isAdmin),localStorage.setItem("isAdmin",i.isAdmin),localStorage.setItem("isLogin",i.valid),localStorage.setItem("token",i.token),localStorage.setItem("custommerid",i.custommerId),localStorage.setItem("lastLoginTime",s.loginTimestamp),localStorage.setItem("clientInfo",JSON.stringify(a.clientInfo)),sessionStorage.setItem("termsAccepted",!0),f.success("Welcome back!"),setTimeout(()=>{window.location.reload(),I("/")},2e3)):f.error("User may not exist or the password is incorrect. Please check your credentials or create an account.")}else if(r==="login")await b(a.email),f.success("OTP sent to your email"),L("otp");else if(r==="otp"){const s=await h(a.email,a.otp);if(s!=null&&s.valid){const i={...a,loginTimestamp:k()},m=await t(i);m!=null&&m.valid?(d(m.valid),n(m.isAdmin),localStorage.setItem("isAdmin",m.isAdmin),localStorage.setItem("isLogin",m.valid),localStorage.setItem("token",m.token),localStorage.setItem("custommerid",m.custommerId),localStorage.setItem("lastLoginTime",i.loginTimestamp),localStorage.setItem("clientInfo",JSON.stringify(a.clientInfo)),f.success("Welcome back!"),setTimeout(()=>{window.location.reload(),I("/")},2e3)):(f.error("User may not exist or the password is incorrect. Please check your credentials or create an account."),setTimeout(()=>{window.location.reload()},3e3))}else f.error(s.message||"Invalid OTP. Please try again.")}}catch{f.error("An error occurred. Please try again.")}finally{D(!1)}}},ke=async()=>{if(M<5)try{V(!0),await b(a.email),f.success("OTP resent to your email"),J(M+1),N(!0),z(60)}catch{f.error("Failed to resend OTP. Please try again.")}finally{V(!1)}else f.error("You have reached the maximum resend attempts. Please try again later.")},Ie=()=>{L("login"),w({...a,otp:""}),T({...c,otp:null})};return e.jsx(Re,{title:"Vmarg - Login",children:e.jsx(Fe,{maxWidth:"md",sx:{py:{xs:2,md:8}},children:e.jsx(Q,{in:j,timeout:600,children:e.jsx(Ee,{elevation:5,sx:{borderRadius:2,overflow:"hidden",bgcolor:"background.paper"},children:e.jsxs(Y,{container:!0,children:[!S&&e.jsxs(Y,{item:!0,md:5,sx:{background:"linear-gradient(to bottom, #00796b, #004d40)",p:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",color:"white"},children:[e.jsxs(u,{sx:{mb:4},children:[e.jsx(he,{sx:{fontSize:60,mb:2,opacity:.8}}),e.jsx(g,{variant:"h4",fontWeight:"bold",sx:{mb:2},children:"Welcome Back"}),e.jsx(g,{variant:"body1",sx:{opacity:.9,mb:2},children:"Log in to access your V-Marg account and track your devices securely."}),e.jsxs(u,{sx:{mt:4},children:[e.jsx(g,{variant:"subtitle2",sx:{opacity:.8,fontSize:"0.85rem"},children:"Secure login with two-factor authentication"}),e.jsx(g,{variant:"subtitle2",sx:{opacity:.8,fontSize:"0.85rem"},children:"End-to-end encrypted connection"})]})]}),e.jsx(u,{sx:{position:"absolute",bottom:20,opacity:.7},children:e.jsxs(g,{variant:"caption",children:["© ",new Date().getFullYear()," V-Marg by Skoegle"]})})]}),e.jsxs(Y,{item:!0,xs:12,md:7,sx:{p:{xs:2,sm:4},display:"flex",flexDirection:"column"},children:[e.jsxs(u,{sx:{mb:4,textAlign:S?"center":"left"},children:[S&&e.jsx(u,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(he,{color:"primary",sx:{fontSize:40}})}),e.jsx(g,{variant:"h4",fontWeight:"bold",color:"primary",sx:{mb:1},children:r==="login"?"Sign In":"Verify OTP"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:r==="login"?"Enter your credentials to access your account":` We've sent a verification code to ${a.email}`})]}),e.jsxs(Ge,{activeStep:r==="login"?0:1,alternativeLabel:!0,sx:{mb:4},children:[e.jsx(pe,{children:e.jsx(ge,{children:"Credentials"})}),e.jsx(pe,{children:e.jsx(ge,{children:"Verification"})})]}),e.jsxs(u,{component:"form",onSubmit:je,sx:{width:"100%"},children:[r==="login"?e.jsx(Q,{in:r==="login",timeout:500,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(X,{variant:"outlined",fullWidth:!0,error:!!c.email,children:[e.jsx(ee,{htmlFor:"email",children:"Email Address"}),e.jsx(te,{id:"email",type:"email",name:"email",value:a.email,onChange:$,startAdornment:e.jsx(q,{position:"start",children:e.jsx(de,{color:"action"})}),label:"Email Address"}),c.email&&e.jsx(oe,{children:c.email})]}),e.jsxs(X,{variant:"outlined",fullWidth:!0,error:!!c.password,children:[e.jsx(ee,{htmlFor:"password",children:"Password"}),e.jsx(te,{id:"password",type:C?"text":"password",name:"password",value:a.password,onChange:$,startAdornment:e.jsx(q,{position:"start",children:e.jsx(We,{color:"action"})}),endAdornment:e.jsx(q,{position:"end",children:e.jsx(Me,{"aria-label":"toggle password visibility",onClick:()=>B(!C),edge:"end",children:C?e.jsx(Ne,{}):e.jsx(Ve,{})})}),label:"Password"}),c.password&&e.jsx(oe,{children:c.password})]}),e.jsx(u,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(g,{variant:"body2",component:ne,to:"/forgotpassword",target:"_blank",sx:{color:"primary.main",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Forgot Password?"})})]})}):e.jsx(Q,{in:r==="otp",timeout:500,children:e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(u,{sx:{mb:1},children:[e.jsx(ae,{startIcon:e.jsx(Je,{}),onClick:Ie,sx:{color:"text.secondary",mb:2},children:"Back to Login"}),e.jsx(He,{variant:"outlined",sx:{mb:2,bgcolor:"primary.50"},children:e.jsxs(Ue,{children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(de,{color:"primary",sx:{mr:1}}),e.jsx(g,{variant:"body2",fontWeight:"medium",children:a.email})]}),e.jsx(g,{variant:"caption",color:"text.secondary",children:"Please check your email inbox for the OTP and enter it below"})]})})]}),e.jsxs(X,{variant:"outlined",fullWidth:!0,error:!!c.otp,children:[e.jsx(ee,{htmlFor:"otp",children:"Enter OTP"}),e.jsx(te,{id:"otp",name:"otp",value:a.otp,onChange:$,startAdornment:e.jsx(q,{position:"start",children:e.jsx(Ze,{color:"action"})}),label:"Enter OTP"}),c.otp&&e.jsx(oe,{children:c.otp})]}),e.jsx(ae,{variant:"outlined",color:"secondary",disabled:R||O,onClick:ke,startIcon:O&&e.jsx(me,{size:16,color:"inherit"}),children:O?"Resending...":R?`Resend OTP (${A}s)`:"Resend OTP"})]})}),e.jsxs(e.Fragment,{children:[!sessionStorage.getItem("termsAccepted")&&e.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(lt,{checked:H,onChange:o=>_(o.target.checked)}),e.jsxs(g,{children:["By creating an account, you agree to the"," ",e.jsx(ue,{variant:"body2",component:ne,to:"https://skoegle.in/Terms%20and%20Conditions.html",target:"_blank",sx:{color:"primary.main",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Terms and Conditions"})]})]}),e.jsx(u,{children:e.jsx(ae,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:!H||P,startIcon:P?e.jsx(me,{size:20,color:"inherit"}):e.jsx(qe,{}),sx:{mt:3,py:1.2,borderRadius:30,backgroundColor:"#00796b",fontWeight:"bold","&:hover":{backgroundColor:"#00635a"},boxShadow:2},children:P?"Please wait...":"Continue"})})]}),r==="login"&&e.jsx(u,{sx:{mt:3,textAlign:"center"},children:e.jsxs(g,{variant:"body2",children:["Don't have an account?"," ",e.jsx(ue,{component:ne,to:"/signup",sx:{fontWeight:"bold",color:"primary.main",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Sign Up"})]})})]})]})]})})})})})}export{pt as default};
