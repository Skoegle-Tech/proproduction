import{u as A,r as o,j as r,L as j,B as c,C as W,n as k,P as B,G as i,T as h,b as u,c as v,y as w}from"./index-D6Gusm_8.js";import{A as F}from"./Avatar-Bv-OVoJO.js";function D(){var N,b;const{fetchUserProfile:x,updateUserProfile:y}=A(),[L,C]=o.useState(null),[n,p]=o.useState(!1),[a,f]=o.useState({}),[P,g]=o.useState(!0),[d,E]=o.useState(""),[t,S]=o.useState({});o.useEffect(()=>{(async()=>{try{const e=await x();C(e==null?void 0:e.user),f({firstName:e==null?void 0:e.user.firstName,lastName:e==null?void 0:e.user.lastName,email:e==null?void 0:e.user.email,phoneNumber:e==null?void 0:e.user.phoneNumber,custommerId:e==null?void 0:e.user.custommerId,password:e==null?void 0:e.user.password}),g(!1)}catch(e){console.error("Error fetching user profile:",e),g(!1)}})()},[x]);const l=s=>{const{name:e,value:m}=s.target;f({...a,[e]:m})},I=()=>{const s={};a.firstName||(s.firstName="First name is required."),a.lastName||(s.lastName="Last name is required."),a.email||(s.email="Email is required."),a.phoneNumber||(s.phoneNumber="Phone number is required."),d&&d.length<6&&(s.password="Password must be at least 6 characters.");const e=/^[0-9]{10}$/;a.phoneNumber&&!e.test(a.phoneNumber)&&(s.phoneNumber="Phone number must be 10 digits.");const m=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return a.email&&!m.test(a.email)&&(s.email="Invalid email format."),s},T=async()=>{const s=I();if(S(s),Object.keys(s).length>0)return;const e={...a};d&&(e.password=d);try{await y(e),p(!1),E(""),w.success("Profile updated successfully!")}catch(m){console.error("Error updating profile:",m),w.error("User with the same details may already exist")}};return P?r.jsx(j,{children:r.jsx(c,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:r.jsx(W,{})})}):r.jsx(j,{children:r.jsx(k,{maxWidth:"lg",children:r.jsx(B,{elevation:3,sx:{padding:4,borderRadius:"12px"},children:r.jsxs(i,{container:!0,spacing:3,children:[r.jsxs(i,{item:!0,xs:12,md:4,container:!0,direction:"column",alignItems:"center",children:[r.jsxs(F,{sx:{width:120,height:120,marginBottom:2,backgroundColor:"#00796b",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"40px"},children:[(N=a.firstName)==null?void 0:N.charAt(0).toUpperCase(),(b=a.lastName)==null?void 0:b.charAt(a.lastName.length-1).toUpperCase()]}),r.jsxs(h,{variant:"h5",sx:{fontWeight:"bold"},children:[a.firstName," ",a.lastName]}),r.jsx(h,{variant:"body2",sx:{color:"gray"},children:a.custommerId})]}),r.jsxs(i,{item:!0,xs:12,md:8,children:[r.jsxs(c,{children:[r.jsx(h,{variant:"h6",sx:{marginBottom:2},children:"Profile Details"}),r.jsxs(i,{container:!0,spacing:2,children:[r.jsx(i,{item:!0,xs:12,sm:6,children:r.jsx(u,{label:"First Name",variant:"outlined",fullWidth:!0,disabled:!n,name:"firstName",value:a.firstName||"",onChange:l,error:!!t.firstName,helperText:t.firstName})}),r.jsx(i,{item:!0,xs:12,sm:6,children:r.jsx(u,{label:"Last Name",variant:"outlined",fullWidth:!0,disabled:!n,name:"lastName",value:a.lastName||"",onChange:l,error:!!t.lastName,helperText:t.lastName})}),r.jsx(i,{item:!0,xs:12,children:r.jsx(u,{label:"Email",variant:"outlined",fullWidth:!0,disabled:!n,name:"email",value:a.email||"",onChange:l,error:!!t.email,helperText:t.email})}),r.jsx(i,{item:!0,xs:12,children:r.jsx(u,{label:"Phone Number",variant:"outlined",fullWidth:!0,disabled:!n,name:"phoneNumber",value:a.phoneNumber||"",onChange:l,error:!!t.phoneNumber,helperText:t.phoneNumber})}),n&&r.jsx(i,{item:!0,xs:12,children:r.jsx(u,{label:"New Password",variant:"outlined",fullWidth:!0,type:"password",name:"password",value:a.password,onChange:l,placeholder:"Enter new password",error:!!t.password,helperText:t.password})})]})]}),r.jsxs(c,{mt:3,display:"flex",justifyContent:"space-between",children:[r.jsx(v,{variant:"outlined",color:"primary",onClick:()=>p(!n),children:n?"Cancel":"Edit"}),n&&r.jsx(v,{variant:"contained",color:"secondary",onClick:T,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"}},children:"Save Changes"})]})]})]})})})})}export{D as default};
