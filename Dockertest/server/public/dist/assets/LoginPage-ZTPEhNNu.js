import{u as D,a as E,r,j as t,B as T,P as W,T as u,b as f,I as $,V as R,c as F,C as V,y as s,L as q}from"./index-D6Gusm_8.js";import{I as z,V as N}from"./VisibilityOff-CAcMtkAm.js";function O(){const{login:p,setisAdmin:h,setisLogin:x}=D(),v=E(),[a,l]=r.useState({email:"",password:"",devicedetails:"Not"}),[i,y]=r.useState({}),[c,d]=r.useState(!1),[g,w]=r.useState(!1);r.useEffect(()=>{(async()=>{try{navigator.geolocation.getCurrentPosition(async o=>{const{latitude:n,longitude:C}=o.coords,P=((await navigator.getBattery()).level*100).toFixed(0),S=navigator.userAgent,k=`${navigator.platform} - ${S}`,L=(await(await fetch("https://api.ipify.org/?format=json")).json()).ip,A=`Latitude: ${n}, Longitude: ${C}, Battery: ${P}%, IP: ${L}, Device: ${k}`;l(B=>({...B,devicedetails:A}))},o=>{console.error("Error getting geolocation: ",o),s.error("Unable to fetch location")})}catch(o){console.error("Error fetching device details: ",o),s.error("Error fetching device details")}})()},[]);const m=e=>{const{name:o,value:n}=e.target;l({...a,[o]:n})},b=()=>{const e={};return a.email||(e.email="Email is required"),a.password||(e.password="Password is required"),y(e),Object.keys(e).length===0},j=async()=>{if(b()){d(!0);try{const e=await p(a);e!=null&&e.valid?(x(e.valid),h(e.isAdmin),localStorage.setItem("isAdmin",e.isAdmin),localStorage.setItem("isLogin",e.valid),localStorage.setItem("token",e.token),localStorage.setItem("custommerid",e.custommerId),s.success("Welcome back!"),window.location.reload(),setTimeout(()=>{v("/")},2e3)):s.error("Invalid email or password.")}catch{s.error("Login failed. Please try again.")}finally{d(!1)}}},I=()=>w(e=>!e);return t.jsx(T,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"70vh",backgroundColor:"#f4f6f8",padding:2},children:t.jsxs(W,{elevation:6,sx:{width:"100%",maxWidth:420,padding:4,borderRadius:3,backgroundColor:"#ffffff"},children:[t.jsx(u,{variant:"h4",sx:{fontWeight:600,textAlign:"center",marginBottom:3,color:"#333"},children:"Welcome Back"}),t.jsx(f,{label:"Email",name:"email",variant:"outlined",fullWidth:!0,value:a.email,onChange:m,error:!!i.email,helperText:i.email,sx:{marginBottom:2}}),t.jsx(f,{label:"Password",name:"password",variant:"outlined",type:g?"text":"password",fullWidth:!0,value:a.password,onChange:m,error:!!i.password,helperText:i.password,InputProps:{endAdornment:t.jsx(z,{position:"end",children:t.jsx($,{onClick:I,children:g?t.jsx(R,{}):t.jsx(N,{})})})},sx:{marginBottom:3}}),t.jsx(F,{variant:"contained",color:"primary",fullWidth:!0,onClick:j,disabled:c,sx:{padding:1.5,fontSize:"1rem",backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"}},children:c?t.jsx(V,{size:24,color:"inherit"}):"Sign In"}),t.jsxs(u,{variant:"body2",sx:{marginTop:2,textAlign:"center",color:"#555"},children:["Forgot your password?"," ",t.jsx("a",{href:"/#",style:{color:"#00796b",textDecoration:"none"},children:"Reset it here"})]})]})})}function M(){return t.jsx(q,{children:t.jsx(O,{})})}export{M as default};
